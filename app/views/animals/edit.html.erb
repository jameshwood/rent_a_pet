<h1>Edit Animal Listing</h1>


<div class="form-group">
  <h3>Current Photos</h3>
  <% if @animal.photos.attached? %>
    <% @animal.photos.each do |photo| %>
      <div class="photo-wrapper">
        <%= image_tag photo, class: "img-thumbnail", width: 150, height: 150 %>
        <%= button_to "Delete Photo", delete_photo_animal_path(@animal, photo_id: photo.id),
                      method: :delete,
                      class: "btn btn-danger btn-sm",
                      data: { confirm: "Are you sure you want to delete the photo?" } %>
      </div>
    <% end %>
  <% else %>
    <p>No photos uploaded yet.</p>
  <% end %>
</div>


<%= simple_form_for @animal, html: { multipart: true } do |f| %>
  <% if @animal.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@animal.errors.count, "error") %> prohibited this listing from being saved:</h2>
      <ul>
        <% @animal.errors.full_messages.each do |message| %>
          <li><%= message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <div class="form-group">
    <%= f.input :photos, as: :file, label: "Upload Additional Photos", input_html: { multiple: true } %>
  </div>

  <div class="form-group">
    <%= f.input :name, label: "Animal Name", input_html: { class: "form-control" } %>
  </div>

  <div class="form-group">
    <%= f.input :species, label: "Species", input_html: { class: "form-control" } %>
  </div>

  <div class="form-group">
    <%= f.input :age, label: "Age (years)", input_html: { class: "form-control" } %>
  </div>

  <div class="form-group">
    <%= f.input :price, label: "Price (per day)", input_html: { class: "form-control", step: 0.01 } %>
  </div>

  <div class="form-group">
    <%= f.input :address, label: "address", input_html: { class: "form-control", step: 0.01 } %>
  </div>

  <div class="form-group">
    <%= f.input :description, label: "Description", input_html: { class: "form-control" } %>
  </div>

  <div class="form-group">
    <%= f.input :available_start,
            as: :string,
            input_html: { value: @animal.available_start&.strftime("%Y-%m-%d"),
            data: { controller: "datepicker" } } %>
  </div>

  <div class="form-group">
    <%= f.input :available_end,
            as: :string,
            input_html: { value: @animal.available_end&.strftime("%Y-%m-%d"),
            data: { controller: "datepicker" } } %>
  </div>

  <div class="form-actions">
    <%= f.button :submit, "Update Listing", class: "btn btn-primary" %>
  </div>
<% end %>
